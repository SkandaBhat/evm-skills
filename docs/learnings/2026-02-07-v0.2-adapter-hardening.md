# v0.2 Adapter Hardening (2026-02-07)

## Scope
Implemented `v0.2` runtime hardening for sensitive transaction/signing paths and dropped `v0.3` as a planned milestone.

## Implemented in v0.2
- Adapter preflight validation module:
  - `evm/scripts/adapters.py`
- Wrapper integration:
  - `evm/scripts/evm_rpc.py` now executes adapter preflight for methods marked `implementation=adapter`.
- New adapter-validated methods:
  - `eth_accounts`
  - `eth_sign`
  - `eth_signTransaction`
  - `eth_sendRawTransaction`
  - `eth_sendTransaction`
- Broadcast-specific remote error mapping:
  - `RPC_BROADCAST_NONCE_TOO_LOW`
  - `RPC_BROADCAST_ALREADY_KNOWN`
  - `RPC_BROADCAST_UNDERPRICED`
  - `RPC_BROADCAST_INSUFFICIENT_FUNDS`
- Policy hardening:
  - broadcast/operator `confirmation_token` now requires minimum length (`>= 8`).

## Validation behavior added
- Mixed fee mode rejected (`gasPrice` with EIP-1559 fee fields).
- Tx object safety checks:
  - require valid `from`
  - require at least one of `to` or `data`
  - validate hex quantity fields when present.
- Raw tx send requires non-empty hex bytes.

## Tests added/expanded
- `evm/tests/test_evm_rpc_wrapper.py` expanded with:
  - short confirmation token denial
  - adapter validation failures for malformed local-sensitive/broadcast requests
  - broadcast-specific remote error code mapping

## Result
- `pytest -q evm/tests` -> `11 passed`
- Coverage/story checks remain green (`69/69`).

## Versioning decision
- `v0.3` is dropped as a planned version.
- Additional operator (`engine_*`) preflight hardening is backlog work without a version label.

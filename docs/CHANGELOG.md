# Docs Changelog

## 2026-02-08
- Changed RPC configuration model from required env to default+override:
  - runtime now resolves endpoints in this order: `ETH_RPC_URL` -> `ETH_RPC_DEFAULT_URLS` -> built-in mainnet pool
  - built-in mainnet pool currently includes:
    - `https://ethereum-rpc.publicnode.com`
    - `https://eth.drpc.org`
    - `https://1rpc.io/eth`
    - `https://eth.llamarpc.com`
  - default-pool failover only advances on transport/timeout failures
  - explicit `ETH_RPC_URL` disables public-pool fallback
- Added learning note for RPC endpoint precedence and fallback behavior (`docs/learnings/2026-02-08-rpc-default-pool-override.md`).
- Updated active docs and skill guidance for optional `ETH_RPC_URL` override behavior:
  - `README.md`
  - `evm/SKILL.md`
  - `docs/plans/usability-prompt-pack.md`
  - `docs/plans/cast-hybrid-architecture.md`
  - `evm/references/user-stories.json`
  - `evm/references/user-stories.md`
- Added Codex repo-discovery packaging path:
  - created `.agents/skills/evm` as a symlink alias to the canonical `evm/` skill package
  - retained `evm/` paths to avoid breaking existing docs/tests/tooling references
- Added learning note for the packaging decision (`docs/learnings/2026-02-08-codex-repo-discovery-packaging.md`).
- Updated docs index and top-level README references for the new discovery path.
- Added usability prompt-pack plan (`docs/plans/usability-prompt-pack.md`) with:
  - session harness prompt,
  - quick 5-prompt regression pack,
  - extended 10-prompt pack for pre-release checks,
  - scoring rubric and run-log template.
- Tuned usability prompt-pack defaults after live mainnet pass:
  - changed quick-pack USDC logs window from `last 2000 blocks` to `last 100 blocks` to avoid `LOGS_TOO_MANY_RESULTS`,
  - clarified ABI decode prompt to normalize cast-formatted numeric strings to plain integer digits.

## 2026-02-07
- Simplified test layout:
  - split monolithic `evm/tests/test_evm_rpc_wrapper.py` into focused suites:
    - `evm/tests/test_exec_policy.py`
    - `evm/tests/test_chain.py`
    - `evm/tests/test_logs.py`
    - `evm/tests/test_analytics.py`
    - `evm/tests/test_abi_multicall_sim_trace.py`
    - `evm/tests/test_convenience.py`
  - added shared harness `evm/tests/_evm_rpc_helpers.py`
- Simplified docs layout:
  - moved superseded learnings to `docs/archive/learnings/`
  - moved superseded plans to `docs/archive/plans/`
  - updated active docs index in `docs/README.md`
- Simplified runtime internals after repository audit:
  - removed custom keccak implementation from `evm/scripts/transforms.py`
  - added shared quantity parser module (`evm/scripts/quantity.py`)
  - switched `abi_codec.decode_log` topic derivation to cast-backed helper path
  - added command prelude helpers (`_require_manifest`, `_require_env_json`) and removed repeated boilerplate across command handlers
  - removed unused analytics helper (`topk_by_numeric_field`)
- Added simplification learning note (`docs/learnings/2026-02-07-simplification-pass.md`).
- Added analytics foundation modules:
  - `evm/scripts/analytics_registry.py`
  - `evm/scripts/analytics_time_range.py`
  - `evm/scripts/analytics_scanner.py`
  - `evm/scripts/analytics_aggregators.py`
- Added initial analytics commands:
  - `analytics dex-swap-flow`
  - `analytics factory-new-pools`
- Added `cast_format_units` adapter support for decimal rendering in analytics outputs.
- Added analytics integration tests in `evm/tests/test_evm_rpc_wrapper.py`.
- Added analytics learning and roadmap docs (`docs/learnings/2026-02-07-analytics-foundation-v0.1.md`, `docs/plans/analytics-commands-plan.md`).
- Pivoted runtime architecture to a cast-backed hybrid model while preserving wrapper policy/safety orchestration.
- Added `evm/scripts/cast_adapter.py` and delegated low-level RPC/ABI/namehash/unit primitives to `cast`.
- Updated `evm/scripts/rpc_transport.py` to use `cast rpc` by default and keep direct HTTP transport for deterministic `eth_getLogs` chunk/split behavior.
- Added logs CLI output/filter controls (`--event`, `--last`, `--decode-erc20-transfer`, output shaping flags).
- Removed import-time cast dependency in `evm/scripts/evm_rpc.py` (constant topic0 now static) so startup errors are avoided.
- Added runtime guard tests for missing-cast behavior and transport split guarantees (`evm/tests/test_evm_rpc_wrapper.py`).
- Added cast-hybrid learning note and architecture plan (`docs/learnings/2026-02-07-cast-hybrid-runtime.md`, `docs/plans/cast-hybrid-architecture.md`).
- Updated `README.md`, `evm/SKILL.md`, and docs index for cast dependency/architecture updates.
- Renamed skill package path from `evm-jsonrpc-wallet/` to `evm/`.
- Updated all docs/plans/learnings to the `evm/` package path.
- Implemented packaged runtime wrapper `evm/scripts/evm_rpc.py` with policy-first JSON-RPC execution.
- Added wrapper support modules (`rpc_contract`, `method_registry`, `policy_eval`, `rpc_transport`, `error_map`, `coverage_check`).
- Added wrapper runtime tests (`evm/tests/test_evm_rpc_wrapper.py`).
- Added runtime implementation learning note (`docs/learnings/2026-02-07-evm-wrapper-v0.1.md`).
- Updated skill and plans to reflect v0.1 runtime availability and current milestone status.
- Implemented `v0.2` adapter hardening (`evm/scripts/adapters.py`) for local-sensitive and broadcast methods.
- Added broadcast-specific remote error mapping for common transaction publish failures.
- Enforced minimum confirmation token length for broadcast/operator gated calls.
- Updated plans to mark `v0.3` as dropped; additional `engine_*` hardening moved to optional backlog.
- Added `v0.2` learning note (`docs/learnings/2026-02-07-v0.2-adapter-hardening.md`).
- Added detailed chain usability plan (`docs/plans/chain-usability-expansion.md`) for `chain`/`batch`, templating, output selectors, transforms, and convenience commands.
- Implemented and documented `v0.2.x` chain usability expansion and validation outcomes (`docs/learnings/2026-02-07-chain-usability-expansion.md`).
- Updated core plans/architecture docs to include shipped multi-step runtime and output shaping.
- Updated docs index to include new plan/learning entries and `transforms.py` module mapping.
- Cleaned documentation set and removed obsolete legacy-learning notes.
- Added advanced capability implementation plan for logs, ABI, multicall, simulation, traces, and provenance (`docs/plans/advanced-json-rpc-capabilities-plan.md`).
- Shipped R1 advanced capabilities: chunked `logs` command, heavy-read guard, adaptive split, deterministic dedupe (`evm/scripts/logs_engine.py`).
- Shipped R2 advanced capabilities: `abi` command, ABI transforms, and client-side `multicall` command (`evm/scripts/abi_codec.py`, `evm/scripts/multicall_engine.py`).
- Shipped R3 advanced capabilities: `simulate` and `trace` commands with revert decoding and trace unsupported handling (`evm/scripts/simulate_engine.py`, `evm/scripts/trace_engine.py`).
- Added R2/R3 learning note: `docs/learnings/2026-02-07-r2-r3-abi-multicall-simulate-trace.md`.
- Added top-level `README.md` with a human-to-agent “Prompting Agents” getting-started section and reusable prompt templates.

## 2026-02-06
- Initialized project documentation structure under `docs/`.
- Added persistent docs maintenance rules (`docs/AGENTS.md`).
- Added Agent Skills spec findings.
- Added OpenAI Codex skills docs gap check and repository alignment recommendations (`.agents/skills` path and optional `agents/openai.yaml`).
- Added cross-ecosystem update-pattern research (Codex, Agent Skills, OpenSkills, SkillPort, Claude plugins) with rollout implications for installed snapshots.
- Added JSON-RPC method inventory from `ethereum/execution-apis` (`69` methods: `eth=40`, `debug=5`, `engine=24`).
- Added `evm` skill skeleton (JSON-RPC-only runtime).
- Added inventory sync script: `evm/scripts/sync_execution_apis_inventory.py`.
- Added JSON-RPC-only implementation plan (`docs/plans/json-rpc-only-skill-plan.md`).
- Added a dedicated JSON-RPC wrapper architecture plan covering module boundaries, request/response contract, policy flow, error taxonomy, retries, and test strategy.
- Added method manifest generation and a complete user story catalog for agent workflows.
- Added user story validator enforcing schema, tier/context policy alignment, and optional full method coverage.

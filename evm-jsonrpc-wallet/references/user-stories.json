{
  "version": "2026-02-06",
  "description": "Agent-facing user stories for JSON-RPC wrapper behavior and method coverage.",
  "stories": [
    {
      "id": "chain-health-dashboard",
      "title": "Monitor chain health and fee conditions",
      "persona": "autonomous-observer-agent",
      "goal": "As an agent, I want to detect chain liveness and fee pressure before taking actions.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_chainId",
        "eth_syncing",
        "eth_blockNumber",
        "eth_blobBaseFee",
        "eth_gasPrice",
        "eth_maxPriorityFeePerGas",
        "eth_feeHistory",
        "eth_coinbase"
      ],
      "acceptance_criteria": [
        "Returns chain ID and sync state in one workflow.",
        "Surfaces fee metrics for decision-making.",
        "Fails with RPC_URL_REQUIRED when ETH_RPC_URL is missing."
      ]
    },
    {
      "id": "account-state-audit",
      "title": "Audit account state",
      "persona": "risk-agent",
      "goal": "As an agent, I want to inspect account state before simulation or execution.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_getBalance",
        "eth_getTransactionCount",
        "eth_getCode",
        "eth_getStorageAt",
        "eth_getProof"
      ],
      "acceptance_criteria": [
        "Returns balance, nonce, code, and proof data.",
        "Supports block tag selection for deterministic reads."
      ]
    },
    {
      "id": "contract-read-and-simulate",
      "title": "Read and preflight contract execution",
      "persona": "execution-planner-agent",
      "goal": "As an agent, I want to simulate and estimate execution cost before publishing transactions.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_call",
        "eth_estimateGas",
        "eth_createAccessList",
        "eth_simulateV1"
      ],
      "acceptance_criteria": [
        "Preflight methods return structured success or RPC_REMOTE_ERROR.",
        "No broadcast permission is required."
      ]
    },
    {
      "id": "transaction-lookup-by-hash",
      "title": "Inspect transaction by hash",
      "persona": "support-agent",
      "goal": "As an agent, I want to fetch transaction lifecycle details from hash input.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_getTransactionByHash",
        "eth_getTransactionReceipt"
      ],
      "acceptance_criteria": [
        "Returns both transaction envelope and receipt when available.",
        "Gracefully handles pending or dropped transactions."
      ]
    },
    {
      "id": "transaction-lookup-by-block-position",
      "title": "Inspect transaction by block position",
      "persona": "forensics-agent",
      "goal": "As an agent, I want indexed access to transactions in canonical blocks.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_getTransactionByBlockHashAndIndex",
        "eth_getTransactionByBlockNumberAndIndex"
      ],
      "acceptance_criteria": [
        "Supports both hash-based and number-based addressing.",
        "Returns nulls cleanly when index is out of range."
      ]
    },
    {
      "id": "block-and-receipts-inspection",
      "title": "Inspect block and receipt aggregates",
      "persona": "analytics-agent",
      "goal": "As an agent, I want complete block-level statistics for monitoring.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_getBlockByHash",
        "eth_getBlockByNumber",
        "eth_getBlockReceipts",
        "eth_getBlockTransactionCountByHash",
        "eth_getBlockTransactionCountByNumber",
        "eth_getUncleCountByBlockHash",
        "eth_getUncleCountByBlockNumber"
      ],
      "acceptance_criteria": [
        "Supports block retrieval by hash and number.",
        "Provides tx and uncle count metrics."
      ]
    },
    {
      "id": "log-backfill",
      "title": "Backfill contract logs over a range",
      "persona": "indexer-agent",
      "goal": "As an agent, I want deterministic log extraction for historical windows.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_getLogs"
      ],
      "acceptance_criteria": [
        "Accepts topic filters and block ranges.",
        "Handles empty result sets as normal outcome."
      ]
    },
    {
      "id": "custom-filter-lifecycle",
      "title": "Run custom filter lifecycle",
      "persona": "alerting-agent",
      "goal": "As an agent, I want to create, poll, and retire JSON-RPC filters safely.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_newFilter",
        "eth_getFilterChanges",
        "eth_getFilterLogs",
        "eth_uninstallFilter"
      ],
      "acceptance_criteria": [
        "Filter ID lifecycle is represented end-to-end.",
        "Wrapper does not persist filter IDs beyond request scope."
      ]
    },
    {
      "id": "new-block-and-pending-filters",
      "title": "Monitor new blocks and pending transactions",
      "persona": "trading-agent",
      "goal": "As an agent, I want low-latency new-head and mempool polling.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_newBlockFilter",
        "eth_newPendingTransactionFilter",
        "eth_getFilterChanges",
        "eth_uninstallFilter"
      ],
      "acceptance_criteria": [
        "Supports both block and pending filters.",
        "Poll/uninstall sequence is explicit in workflow."
      ]
    },
    {
      "id": "local-account-operations",
      "title": "Use node-local account authority",
      "persona": "custodial-ops-agent",
      "goal": "As an agent, I want controlled access to local signing capabilities.",
      "tier": "local-sensitive",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": true,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "eth_accounts",
        "eth_sign",
        "eth_signTransaction"
      ],
      "acceptance_criteria": [
        "Denied unless allow_local_sensitive is true.",
        "No broadcast should occur in this story."
      ]
    },
    {
      "id": "broadcast-raw-signed-transaction",
      "title": "Publish signed raw transaction",
      "persona": "execution-agent",
      "goal": "As an agent, I want to broadcast pre-signed transactions with explicit confirmation.",
      "tier": "broadcast",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": true,
        "allow_operator": false,
        "requires_confirmation": true
      },
      "methods": [
        "eth_sendRawTransaction"
      ],
      "acceptance_criteria": [
        "Denied unless allow_broadcast and confirmation are provided.",
        "Returns tx hash or RPC remote error."
      ]
    },
    {
      "id": "broadcast-node-managed-transaction",
      "title": "Publish transaction via node-managed account",
      "persona": "execution-agent",
      "goal": "As an agent, I want to submit transactions through node-managed accounts with safeguards.",
      "tier": "broadcast",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": true,
        "allow_operator": false,
        "requires_confirmation": true
      },
      "methods": [
        "eth_sendTransaction"
      ],
      "acceptance_criteria": [
        "Denied unless broadcast gate and confirmation token are present.",
        "No hidden retries for non-idempotent publish requests by default."
      ]
    },
    {
      "id": "debug-raw-artifact-inspection",
      "title": "Inspect raw execution artifacts",
      "persona": "forensics-agent",
      "goal": "As an agent, I want byte-level artifacts for deep incident analysis.",
      "tier": "read",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": false,
        "requires_confirmation": false
      },
      "methods": [
        "debug_getBadBlocks",
        "debug_getRawBlock",
        "debug_getRawHeader",
        "debug_getRawReceipts",
        "debug_getRawTransaction"
      ],
      "acceptance_criteria": [
        "Handles pruned-history RPC errors without wrapper crashes.",
        "Preserves byte payloads without lossy transforms."
      ]
    },
    {
      "id": "engine-capability-handshake",
      "title": "Run EL-CL capability handshake",
      "persona": "validator-infra-agent",
      "goal": "As an infrastructure agent, I want to verify consensus and execution endpoint compatibility.",
      "tier": "operator",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": true,
        "requires_confirmation": true
      },
      "methods": [
        "engine_exchangeCapabilities",
        "engine_exchangeTransitionConfigurationV1"
      ],
      "acceptance_criteria": [
        "Denied unless operator gate and confirmation are present.",
        "Returns clear diff when transition config mismatches."
      ]
    },
    {
      "id": "engine-forkchoice-control",
      "title": "Manage forkchoice updates across versions",
      "persona": "validator-infra-agent",
      "goal": "As an infrastructure agent, I want versioned forkchoice control for upgrades.",
      "tier": "operator",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": true,
        "requires_confirmation": true
      },
      "methods": [
        "engine_forkchoiceUpdatedV1",
        "engine_forkchoiceUpdatedV2",
        "engine_forkchoiceUpdatedV3",
        "engine_forkchoiceUpdatedV4"
      ],
      "acceptance_criteria": [
        "Supports version selection by fork era.",
        "Returns structured payload status and latest valid hash."
      ]
    },
    {
      "id": "engine-payload-retrieval-and-bodies",
      "title": "Retrieve payloads, bodies, and blobs",
      "persona": "builder-relay-agent",
      "goal": "As an infrastructure agent, I want to retrieve payload artifacts across protocol versions.",
      "tier": "operator",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": true,
        "requires_confirmation": true
      },
      "methods": [
        "engine_getPayloadV1",
        "engine_getPayloadV2",
        "engine_getPayloadV3",
        "engine_getPayloadV4",
        "engine_getPayloadV5",
        "engine_getPayloadV6",
        "engine_getPayloadBodiesByHashV1",
        "engine_getPayloadBodiesByHashV2",
        "engine_getPayloadBodiesByRangeV1",
        "engine_getPayloadBodiesByRangeV2",
        "engine_getBlobsV1",
        "engine_getBlobsV2",
        "engine_getBlobsV3"
      ],
      "acceptance_criteria": [
        "Supports mixed-version payload retrieval workflows.",
        "Surfaces unsupported-fork errors explicitly."
      ]
    },
    {
      "id": "engine-newpayload-validation",
      "title": "Validate incoming payloads across versions",
      "persona": "validator-infra-agent",
      "goal": "As an infrastructure agent, I want to validate payload proposals consistently across fork versions.",
      "tier": "operator",
      "rpc_url_required": true,
      "context_requirements": {
        "allow_local_sensitive": false,
        "allow_broadcast": false,
        "allow_operator": true,
        "requires_confirmation": true
      },
      "methods": [
        "engine_newPayloadV1",
        "engine_newPayloadV2",
        "engine_newPayloadV3",
        "engine_newPayloadV4",
        "engine_newPayloadV5"
      ],
      "acceptance_criteria": [
        "Returns VALID/INVALID status variants without schema drift.",
        "Handles invalid-params and unsupported-fork error codes."
      ]
    }
  ]
}
